<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ€§æ ¼ç¢ç‰‡å°æ¸¸æˆ</title>
<style>
body {margin:0;font-family:sans-serif;background:#fdf6f0;}
button{border:none;border-radius:6px;padding:8px;font-size:14px;cursor:pointer;}
.hidden{display:none;}
.screen,#home{width:100%;height:100vh;position:relative;overflow-y:auto;background:#fdf6f0;}

/* ä¸»è§’å¤§å›¾å…¨å± */
#homeImg img,#drawImg img,#taskImg img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;z-index:0;}

/* ä¸»é¡µèœå• */
#menu{position:absolute;top:10px;right:10px;display:flex;flex-direction:column;z-index:10;}
.menuBtn{width:60px;height:60px;margin:5px 0;background:#fff;border:1px solid #333;display:flex;align-items:center;justify-content:center;font-size:12px;cursor:pointer;}

/* é€šç”¨è¿”å›æŒ‰é’® */
.backBtn{position:absolute;left:10px;top:10px;width:40px;height:40px;background:#fff;border:1px solid #333;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:18px;cursor:pointer;z-index:20;}

/* æŠ½å¡ç•Œé¢ */
#drawTitle{position:absolute;left:10px;top:60px;writing-mode: vertical-rl;font-size:18px;font-weight:bold;z-index:10;}
#drawResource{position:absolute;top:10px;right:10px;font-size:16px;z-index:10;}
#drawBtn{position:absolute;bottom:50px;left:50%;transform:translateX(-50%);width:120px;height:120px;z-index:10;}

/* å¡åŒ…ç•Œé¢ */
#collectionTitle{position:absolute;top:10px;left:50%;transform:translateX(-50%);font-size:18px;font-weight:bold;z-index:10;}
#collectionResource{position:absolute;top:10px;right:10px;font-size:16px;z-index:10;}
#cards,#catalogCards{display:grid;grid-template-columns:repeat(2,1fr);justify-items:center;margin-top:60px;gap:10px;}

/* å¡ç‰Œæ ·å¼ */
.card{width:140px;height:200px;border:2px solid #333;border-radius:10px;background:#fff;box-sizing:border-box;position:relative;overflow:hidden;text-align:center;font-weight:bold;}
.card img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;z-index:0;border-radius:6px;}
.cardContent{position:absolute;bottom:5px;left:50%;transform:translateX(-50%);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1;background:transparent;padding:0;color:#fff;text-shadow:1px 1px 2px #000;}
.cardContent .nameRarity{font-size:14px;margin-bottom:2px;}
.cardContent .level{font-size:12px;margin-bottom:4px;}
.cardContent button{width:60px;height:24px;font-size:12px;}
.locked .cardContent{opacity:0.6;}
.locked img{filter:grayscale(100%);} /* æœªè§£é”å˜ç° */

/* å…¨å›¾é‰´æ ‡é¢˜ */
#catalogTitle{position:absolute;top:10px;left:50%;transform:translateX(-50%);font-size:18px;font-weight:bold;z-index:10;}

/* ä»»åŠ¡ç•Œé¢ */
#taskTitle{position:absolute;top:10px;left:50%;transform:translateX(-50%);font-size:18px;font-weight:bold;z-index:10;color: white;}
#taskResource{position:absolute;top:10px;right:10px;font-size:16px;line-height:1.5em;text-align:right;z-index:10;color: white;}
#taskBtn{position:absolute;bottom:50px;left:50%;transform:translateX(-50%);width:140px;height:50px;z-index:10;}
</style>
</head>
<body>

<!-- ä¸»é¡µ -->
<div id="home">
  <div id="homeImg"><img src="images/home_main.png"></div>
  <div id="menu">
    <div class="menuBtn" onclick="showScreen('draw')">æŠ½å¡</div>
    <div class="menuBtn" onclick="showScreen('collection')">å¡åŒ…</div>
    <div class="menuBtn" onclick="showScreen('catalog')">å…¨å›¾é‰´</div>
    <div class="menuBtn" onclick="showScreen('task')">ä»»åŠ¡</div>
  </div>
</div>

<!-- æŠ½å¡ç•Œé¢ -->
<div id="draw" class="screen hidden">
  <div class="backBtn" onclick="showScreen('home')">ğŸ </div>
  <div id="drawTitle">æŠ½å¡ç•Œé¢</div>
  <div id="drawResource">æŠ½å¡æœºä¼š: 0</div>
  <div id="drawImg"><img src="images/draw_main.png"></div>
  <div id="drawBtn"><button style="width:100%;height:100%;" onclick="drawCard()">æŠ½å¡</button></div>
</div>

<!-- å¡åŒ…ç•Œé¢ -->
<div id="collection" class="screen hidden">
  <div class="backBtn" onclick="showScreen('home')">ğŸ </div>
  <div id="collectionTitle">å¡åŒ…ç•Œé¢</div>
  <div id="collectionResource">å‡çº§ç‚¹: 0</div>
  <div id="cards"></div>
</div>

<!-- å…¨å›¾é‰´ç•Œé¢ -->
<div id="catalog" class="screen hidden">
  <div class="backBtn" onclick="showScreen('home')">ğŸ </div>
  <div id="catalogTitle">å…¨å›¾é‰´</div>
  <div id="catalogCards"></div>
</div>

<!-- ä»»åŠ¡ç•Œé¢ -->
<div id="task" class="screen hidden">
  <div id="taskImg"><img src="images/task_main.png"></div>
  <div class="backBtn" onclick="showScreen('home')">ğŸ </div>
  <div id="taskTitle">ä»»åŠ¡ç•Œé¢</div>
  <div id="taskResource">æŠ½å¡æœºä¼š:0<br>å‡çº§ç‚¹:0</div>
  <div id="taskBtn"><button style="width:100%;height:100%;" onclick="completeTask()">å®Œæˆä»»åŠ¡</button></div>
</div>

<script>
const personalities = [
  {name:'æ¸©æŸ”', rarity:['â˜…3','â˜…4','â˜…5'], img:{'â˜…3':'images/wenrou_3.png','â˜…4':'images/wenrou_4.png','â˜…5':'images/wenrou_5.png'}},
  {name:'å¼ æ‰¬', rarity:['â˜…3','â˜…4','â˜…5'], img:{'â˜…3':'images/zhangyang_3.png','â˜…4':'images/zhangyang_4.png','â˜…5':'images/zhangyang_5.png'}},
  {name:'ç†æ™º', rarity:['â˜…3','â˜…4','â˜…5'], img:{'â˜…3':'images/lizhi_3.png','â˜…4':'images/lizhi_4.png','â˜…5':'images/lizhi_5.png'}}
];

let ownedCards=[], taskCount=0, drawCount=0, upgradeCount=0;

// ç•Œé¢åˆ‡æ¢
function showScreen(screen){
  ['home','draw','collection','catalog','task'].forEach(s=>document.getElementById(s).classList.add('hidden'));
  document.getElementById(screen).classList.remove('hidden');
  updateAllResources();
  if(screen==='collection') displayCollection();
  if(screen==='catalog') displayCatalog();
  if(screen==='draw') updateResourceDraw();
}

// æ›´æ–°èµ„æº
function updateAllResources(){
  document.getElementById('drawResource').innerText=`æŠ½å¡æœºä¼š: ${drawCount}`;
  document.getElementById('collectionResource').innerText=`å‡çº§ç‚¹: ${upgradeCount}`;
  document.getElementById('taskResource').innerHTML=`æŠ½å¡æœºä¼š:${drawCount}<br>å‡çº§ç‚¹:${upgradeCount}`;
}

// æŠ½å¡
function getRandomRarity(){const r=Math.random();if(r<0.6)return 'â˜…3';if(r<0.9)return 'â˜…4';return 'â˜…5';}
function drawCard(){
  if(drawCount<=0){alert('æ²¡æœ‰æŠ½å¡æœºä¼šï¼Œè¯·å…ˆå®Œæˆä»»åŠ¡ï¼');return;}
  drawCount--;
  const p=personalities[Math.floor(Math.random()*personalities.length)];
  const rarity=getRandomRarity();
  const card={name:p.name,rarity:rarity,level:1,img:p.img[rarity]};
  ownedCards.push(card);
  alert(`æŠ½å¡è·å¾—æ–°å¡ï¼š${card.name} ${card.rarity}`);
  updateAllResources();
  displayCollection();
}

// å¡åŒ…æ˜¾ç¤º
function displayCollection(){
  const div=document.getElementById('cards'); div.innerHTML='';
  for(let i=0;i<ownedCards.length;i++){
    const c=ownedCards[i];
    const cdiv=document.createElement('div'); cdiv.className='card';
    cdiv.innerHTML=`<img src="${c.img}"><div class="cardContent">
      <div class="nameRarity"><strong>${c.name}</strong> ${c.rarity}</div>
      <div class="level">ç­‰çº§:${c.level}</div>
      <button onclick="upgradeCard(${i})">å‡çº§</button>
    </div>`;
    div.appendChild(cdiv);
  }
  if(ownedCards.length%2===1){
    const emptyDiv=document.createElement('div'); emptyDiv.className='card'; emptyDiv.style.visibility='hidden';
    div.appendChild(emptyDiv);
  }
}

// å‡çº§å¡ç‰Œ
function upgradeCard(index){
  if(upgradeCount<=0){alert('æ²¡æœ‰å‡çº§ç‚¹');return;}
  upgradeCount--; ownedCards[index].level++;
  updateAllResources();
  displayCollection();
}

// å®Œæˆä»»åŠ¡
function completeTask(){taskCount++;drawCount++;upgradeCount++;alert('å®Œæˆä»»åŠ¡è·å¾—å¥–åŠ±');updateAllResources();displayCollection();}

// å…¨å›¾é‰´æ˜¾ç¤º
function displayCatalog(){
  const div=document.getElementById('catalogCards'); 
  div.innerHTML='';
  personalities.forEach(p=>{
    p.rarity.forEach(r=>{
      const found = ownedCards.find(c=>c.name===p.name && c.rarity===r);
      const cdiv=document.createElement('div'); 
      cdiv.className='card';
      if(!found) cdiv.classList.add('locked');
      cdiv.innerHTML = `
        <img src="${p.img[r]}">
        <div class="cardContent">
          ${found ? '' : '<div style="font-size:20px;">ğŸ”’</div>'}
          <div class="nameRarity"><strong>${p.name}</strong> ${r}</div>
        </div>`;
      div.appendChild(cdiv);
    });
  });
  if(div.children.length%2===1){
    const emptyDiv=document.createElement('div'); 
    emptyDiv.className='card'; 
    emptyDiv.style.visibility='hidden';
    div.appendChild(emptyDiv);
  }
}

// æŠ½å¡ç•Œé¢æ›´æ–°èµ„æº
function updateResourceDraw(){document.getElementById('drawResource').innerText=`æŠ½å¡æœºä¼š: ${drawCount}`;}
</script>
</body>
</html>